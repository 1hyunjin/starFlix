<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper
	namespace="com.ssafy.starflix.starPlace.model.dao.TravelDAO">

	<select id="getListOfType" resultMap="travel">
		<![CDATA[
			select t.*, 
			(6371 * acos(cos(radians(s.lati)) * cos(radians(t.lati)) * cos(radians(t.long) - radians(s.long)) + sin(radians(s.lati)) * sin(radians(t.lati)))) AS distance
			From travel t , star_place s
			where s.idx = #{idx} and t.type = #{type}
			having distance <= 5
			order by distance asc;
		]]>
	</select>

	<resultMap
		type="com.ssafy.starflix.starPlace.model.dto.TravelDTO" id="travel">
		<result property="idx" column="idx" />
		<result property="type" column="type" />
		<result property="title" column="title" />
		<result property="addr" column="addr" />
		<result property="img" column="img" />
		<result property="sidoCode" column="sido_code" />
		<result property="gugunCode" column="gugun_code" />
		<result property="lati" column="lati" />
		<result property="longj" column="long" />

	</resultMap>
</mapper>